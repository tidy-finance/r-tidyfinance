---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# tidyfinance

<!-- badges: start -->
`r badger::badge_cran_release()`
`r badger::badge_cran_download(type = "grand-total")`
`r badger::badge_repostatus("Active")`
`r badger::badge_github_version(color = "blue")`
[![R-CMD-check](https://github.com/tidy-finance/r-tidyfinance/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/tidy-finance/r-tidyfinance/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

This repository contains an R package that collects helper functions for developers and researchers familiar with [Tidy Finance with R](https://www.tidy-finance.org/r/index.html). The functions provide shortcuts to selected issues that the book discusses in detail.

## Installation 

You can install the released version of `tidyfinance` [from CRAN](https://cran.r-project.org/package=tidyfinance) via:

```r
install.packages("tidyfinance")
```

You can install the development version of `tidyfinance` from [GitHub](https://github.com/tidy-finance/r-tidyfinance) via:

```
# install.packages("pak")
pak::pak("tidy-finance/r-tidyfinance")
```

## Usage

Load the package:

```{r}
library(tidyfinance)
```

## Download Open Source Data

The main functionality of the `tidyfinance` package centers around data download. You can download most of the data that we used in [Tidy Finance with R](https://www.tidy-finance.org/r/index.html) using the `download_data()` function or its children. 

The function always requires a `domain` argument and depending on the domain typically also a `dataset`. For instance, to download monthly Fama-French factors, you have to provide the dataset name according to [Ken French's Data Library](https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html):

```{r}
download_data(
  domain = "factors_ff",
  dataset = "Fama/French 5 Factors (2x3) [Daily]",
  start_date = "2000-01-01",
  end_date = "2020-12-31"
)
```

For [q factors](https://global-q.org/index.html), you provide the relevant file name:

```{r}
download_data(
  domain = "factors_q",
  dataset = "q5_factors_monthly_2024",
  start_date = "2000-01-01",
  end_date = "2020-12-31"
)
```

To download the Welch and Goyal (2008) macroeconomic predictors for monthly, quarterly, or annual frequency:

```{r}
download_data(
  domain = "macro_predictors",
  dataset = "monthly",
  start_date = "2000-01-01",
  end_date = "2020-12-31"
)
```

To download data from [Open Source Asset Pricing](https://www.openassetpricing.com/) (OSAP):

```{r}
download_data(
  domain = "osap",
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

To download multiple series from the Federal Reserve Economic Data (FRED):

```{r}
download_data(
  domain = "fred",
  series = c("GDP", "CPIAUCNS"),
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

To download stock prices from Yahoo Finance:

```{r}
download_data(
  domain = "stock_prices",
  symbols = c("AAPL", "MSFT"),
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

You can also download high-frequency data for the S&P 500 that we host on Hugging Face:

```{r}
download_data(
  domain = "hf",
  dataset = "high_frequency_sp500",
  start_date = "2007-07-26",
  end_date = "2007-07-27"
)
```

## Download WRDS Data

You can also download data directly from [WRDS](https://www.tidy-finance.org/r/wrds-crsp-and-compustat.html) if you have access to the underlying data and set your credentials via `Sys.setenv(WRDS_USER = "your_username", WRDS_PASSWORD = "your_password")` or the `set_wrds_credentials()` helper function. 

To download monthly CRSP data:

```{r}
download_data(
  domain = "wrds",
  dataset = "crsp_monthly",
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

To download annual (or quaterly) Compustat data:

```{r}
download_data(
  domain = "wrds",
  dataset = "compustat_annual",
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

To download the CRSP-Compustat linking table:

```{r}
download_data(
  domain = "wrds",
  dataset = "compustat_annual",
  start_date = "2020-01-01",
  end_date = "2020-12-31"
)
```

To download Enhanced TRACE data for selected bonds:

```{r}
download_data(
  domain = "wrds",
  dataset = "trace_enhanced",
  cusips = c("00101JAH9"),
  start_date = "2019-01-01",
  end_date = "2021-12-31"
)
```

### Other Helpers

We include functions to check out content from [tidy-finance.org](https://www.tidy-finance.org/r/index.html):

```r
list_tidy_finance_chapters()
open_tidy_finance_website()
```

There are also some simple helpers for regression analyses:

```r
winsorize()
trim()
create_summary_statistics()
```

We also include (experimental) functions that can be used for different applications, but note that they might heavily change in future package versions as we try to make them more general:

```r
# For portfolio sorts
?assign_portfolio()

# For model estimation
?estimate_model()

# For beta estimation
?estimate_betas()

# For beta estimation
?estimate_fama_macbeth()
```
